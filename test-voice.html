<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Voice Command Test</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      max-width: 800px;
      margin: 0 auto;
    }
    button {
      padding: 15px 30px;
      font-size: 18px;
      margin: 10px;
      cursor: pointer;
    }
    #output {
      margin-top: 20px;
      padding: 15px;
      background: #f0f0f0;
      border-radius: 5px;
      min-height: 200px;
    }
  </style>
</head>
<body>
  <h1>Voice Command Test</h1>
  <p>This page helps test voice commands for the voting app.</p>
  
  <button onclick="testCommand('vote for candidate 1')">Test: Vote for Candidate 1</button>
  <button onclick="testCommand('confirm')">Test: Confirm</button>
  <button onclick="testCommand('yes')">Test: Yes</button>
  <button onclick="testCommand('candidate 2')">Test: Candidate 2</button>
  
  <div id="output"></div>
  
  <script src="voice.js"></script>
  <script src="script.js"></script>
  <script>
    const output = document.getElementById('output');
    
    function log(message) {
      const p = document.createElement('p');
      p.textContent = new Date().toLocaleTimeString() + ': ' + message;
      output.appendChild(p);
      output.scrollTop = output.scrollHeight;
      console.log(message);
    }
    
    function testCommand(command) {
      log('Testing command: ' + command);
      
      // Set page context to voting
      if (typeof setCurrentPage === 'function') {
        setCurrentPage('voting');
        log('Page context set to: voting');
      }
      
      // Create a mock voting section
      if (!document.getElementById('voting-section')) {
        const section = document.createElement('section');
        section.id = 'voting-section';
        section.style.display = 'block';
        document.body.appendChild(section);
        log('Created mock voting section');
      }
      
      // Create a mock candidate button
      if (!document.getElementById('vote-btn-1')) {
        const btn = document.createElement('button');
        btn.id = 'vote-btn-1';
        btn.className = 'btn btn-vote';
        btn.setAttribute('data-candidate-number', '1');
        btn.textContent = 'Vote';
        btn.onclick = () => {
          log('Vote button clicked!');
          // Create mock modal
          createMockModal();
        };
        document.getElementById('voting-section').appendChild(btn);
        log('Created mock vote button for candidate 1');
      }
      
      // Process the command
      if (typeof handleVoiceCommand === 'function') {
        log('Calling handleVoiceCommand...');
        handleVoiceCommand(command);
      } else {
        log('ERROR: handleVoiceCommand function not found!');
      }
    }
    
    function createMockModal() {
      log('Creating mock confirmation modal...');
      
      // Remove existing modal
      const existing = document.getElementById('confirmation-modal');
      if (existing) existing.remove();
      
      const modal = document.createElement('div');
      modal.id = 'confirmation-modal';
      modal.className = 'modal-overlay';
      modal.style.position = 'fixed';
      modal.style.top = '0';
      modal.style.left = '0';
      modal.style.width = '100%';
      modal.style.height = '100%';
      modal.style.background = 'rgba(0,0,0,0.7)';
      modal.style.display = 'flex';
      modal.style.alignItems = 'center';
      modal.style.justifyContent = 'center';
      modal.style.zIndex = '9999';
      
      const content = document.createElement('div');
      content.className = 'modal-content';
      content.style.background = 'white';
      content.style.padding = '20px';
      content.style.borderRadius = '10px';
      
      const confirmBtn = document.createElement('button');
      confirmBtn.id = 'modal-confirm-btn';
      confirmBtn.className = 'btn btn-success';
      confirmBtn.textContent = 'Confirm';
      confirmBtn.onclick = () => {
        log('Confirm button clicked!');
        modal.remove();
      };
      
      const cancelBtn = document.createElement('button');
      cancelBtn.id = 'modal-cancel-btn';
      cancelBtn.className = 'btn btn-secondary';
      cancelBtn.textContent = 'Cancel';
      cancelBtn.onclick = () => {
        log('Cancel button clicked!');
        modal.remove();
      };
      
      content.appendChild(document.createTextNode('Are you sure?'));
      content.appendChild(document.createElement('br'));
      content.appendChild(confirmBtn);
      content.appendChild(cancelBtn);
      modal.appendChild(content);
      document.body.appendChild(modal);
      
      log('Mock modal created with buttons');
    }
    
    // Initialize voice
    window.addEventListener('DOMContentLoaded', () => {
      log('Page loaded');
      if (typeof initSpeechRecognition === 'function') {
        initSpeechRecognition();
        log('Voice recognition initialized');
      } else {
        log('WARNING: initSpeechRecognition not found');
      }
    });
  </script>
</body>
</html>

